<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Coin To Real Cash - Invite Friends</title>
<link rel="stylesheet" href="assets/css/invite.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
</head>
<body>
<div class="container invite-page-container">
<h2 class="invite-main-title" style="font-size: 25px;">Invite Friend and Get Bonus Instantly</h2>
<p class="invite-subtitle" style="font-size: 15px;">You will get 500 coins and your friend get 250 coins instantly</p>

<div class="illustration-placeholder">
    <img src="assets/image/invite-friend-illustration-svg-download-png-9394077.webp" alt="Refer A Friend Illustration">
</div>

<div class="referral-code-section">
    <div class="input-group referral-code-box">
        <i class="fas fa-copy"></i>
        <input type="text" value="" readonly class="referral-code-input">
        <button class="share-button">Share</button>
    </div>
</div>

<p class="have-referral-code"><a href="referral-code.html">Have a Referral Code?</a></p>

<div class="social-media-invite">
    <p>Invite by Social Media</p>
    <div class="social-icons">
        <a class="social-icon whatsapp" target="_blank"><i class="fab fa-whatsapp"></i></a>
    </div>
</div>

<div class="bottom-nav">
    <a href="home.html" class="nav-item">
        <i class="fas fa-home"></i>
        <span>Home</span>
    </a>
    <a href="invite.html" class="nav-item active">
        <i class="fas fa-user-plus"></i>
        <span>Invite</span>
    </a>
    <a href="wallet.html" class="nav-item">
        <i class="fas fa-wallet"></i>
        <span>Wallet</span>
    </a>
    <a href="profile.html" class="nav-item">
        <i class="fas fa-user-circle"></i>
        <span>Profile</span>
    </a>
</div>
  <script>
const firebaseConfig = {
  apiKey: "AIzaSyAkWyk3q-zaDHkjDs90Bm2ih_qw-O_ZJQU",
  authDomain: "coin-to-real-cash.firebaseapp.com",
  databaseURL: "https://coin-to-real-cash-default-rtdb.firebaseio.com",
  projectId: "coin-to-real-cash",
  storageBucket: "coin-to-real-cash.firebasestorage.app",
  messagingSenderId: "265929655267",
  appId: "1:265929655267:web:7eb846fe7bd104761a56d6"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.database();

// Function to generate unique 6-digit referral code
function generateReferralCode() {
  return Math.floor(100000 + Math.random() * 900000);
}

document.addEventListener("DOMContentLoaded", () => {
  const referralInput = document.querySelector(".referral-code-input");
  const shareBtn = document.querySelector(".share-button");

  auth.onAuthStateChanged(user => {
    if(!user){
      window.location.href = "index.html";
      return;
    }

    const userRef = db.ref("users/" + user.uid);

    userRef.once("value").then(snapshot => {
      let referralCode;
      if(snapshot.exists()){
        const data = snapshot.val();
        if(data.referralCode){
          referralCode = data.referralCode;
          referralInput.value = referralCode;
        } else {
          referralCode = generateReferralCode();
          userRef.update({ referralCode: referralCode });
          referralInput.value = referralCode;
        }
      } else {
        referralCode = generateReferralCode();
        userRef.set({ coins: 0, lastDailyBonus: "", referralCode: referralCode });
        referralInput.value = referralCode;
      }

      const message = `ðŸŽ‰ Hey! Check out Coin To Real Cash!\nGet started with my referral code: ${referralCode} and enjoy 250 coins rewards instantly.\nðŸ“² Download now: https://manojkohar1318.github.io/coin-to-real-cash/\nLetâ€™s earn together! ðŸ’°`;

      // âœ… Fixed Share Button (Opens all sharing apps)
      shareBtn.addEventListener("click", async () => {
        if (navigator.share) {
          try {
            await navigator.share({
              title: "Coin To Real Cash",
              text: message,
              url: "https://manojkohar1318.github.io/cointorealcash/"
            });
            console.log("Share successful!");
          } catch (err) {
            console.error("Share failed:", err);
          }
        } else {
          // Fallback (copy to clipboard)
          try {
            await navigator.clipboard.writeText(message);
            alert("Referral message copied! Paste it into any app to share.");
          } catch (err) {
            referralInput.select();
            referralInput.setSelectionRange(0, 99999);
            document.execCommand("copy");
            alert("Referral code copied! Paste it into any app to share.");
          }
        }
      });

      // âœ… Updated Social Media Links
      const encodedMsg = encodeURIComponent(message);
      // âœ… WhatsApp direct & fallback
      const whatsappLink = `intent://send?text=${encodedMsg}#Intent;package=com.whatsapp;scheme=whatsapp;end`;
      const whatsappWebFallback = `https://wa.me/?text=${encodedMsg}`;
      const whatsappAnchor = document.querySelector(".whatsapp");

      whatsappAnchor.addEventListener("click", (e) => {
        e.preventDefault();
        window.location.href = whatsappLink;
        setTimeout(() => {
          window.location.href = whatsappWebFallback;
        }, 1000);
      });
    });
  });

  // Copy button beside input
  const copyBtn = document.querySelector(".fa-copy");
  copyBtn.addEventListener("click", () => {
    referralInput.select();
    referralInput.setSelectionRange(0, 99999);
    document.execCommand("copy");
    alert("Referral code copied!");
  });
});
</script>
    <script type='text/javascript' src='//pl27953310.effectivegatecpm.com/1c/7f/5d/1c7f5d008047d5459aff5d3c28e44dab.js'></script>
</body>
</html>
